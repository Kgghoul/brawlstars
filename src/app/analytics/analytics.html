<div class="screen">
  <div class="screen-content">
    <div class="group"></div>

    <!-- Заголовок -->
    <div class="text-wrapper-3">АНАЛИТИКА</div>

    <!-- Табы -->
    <div class="frame">
      <div class="div-wrapper" [class.active]="activeTab() === 'general'" (click)="setTab('general')">
        <div class="text-wrapper">ОБЩАЯ</div>
      </div>
      <div class="div" [class.active]="activeTab() === 'detailed'" (click)="setTab('detailed')">
        <div class="text-wrapper-2">ДЕТАЛЬНАЯ</div>
      </div>
    </div>

    <!-- Основной контент -->
    <div class="frame-2">
      <!-- Лучшие карты -->
      <div class="frame-3">
        <div class="text-wrapper-10">ЛУЧШИЕ КАРТЫ</div>
        <div class="frame-wrapper">
          <div class="frame-4" [class.single-map]="bestMaps.length === 1">
            @for (map of bestMaps; track map.name; let i = $index) {
            <div [class]="'map-container ' + (bestMaps.length === 1 ? 'map-centered' : (i === 0 ? 'mask-group' : (i === 1 ? 'img' : 'mask-group-2')))">
              <img [src]="map.image" [alt]="map.name" />
              @if (bestMaps.length === 1) {
              <div class="text-wrapper-centered-wr" [style.color]="getWinRateColor(map.winRate)">{{ map.winRate }}%</div>
              <div class="text-wrapper-centered-name">{{ map.name }}</div>
              }
            </div>
            @if (bestMaps.length > 1) {
            <div [class]="'text-wrapper-' + (i === 0 ? '5' : (i === 1 ? '6' : '7'))" [style.color]="getWinRateColor(map.winRate)">
              {{ map.winRate }}%
            </div>
            <div [class]="'text-wrapper-' + (i === 0 ? '4' : (i === 1 ? '8' : '9'))">
              {{ map.name }}
            </div>
            }
            }
          </div>
        </div>
      </div>

      <!-- Худшие карты -->
      <div class="frame-3">
        <div class="text-wrapper-14">ХУДШИЕ КАРТЫ</div>
        <div class="frame-wrapper">
          <div class="frame-4" [class.single-map]="worstMaps.length === 1">
            @for (map of worstMaps; track map.name; let i = $index) {
            <div [class]="'map-container ' + (worstMaps.length === 1 ? 'map-centered' : (i === 0 ? 'mask-group' : (i === 1 ? 'img' : 'mask-group-2')))">
              <img [src]="map.image" [alt]="map.name" />
              @if (worstMaps.length === 1) {
              <div class="text-wrapper-centered-wr" [style.color]="getWinRateColor(map.winRate)">{{ map.winRate }}%</div>
              <div class="text-wrapper-centered-name">{{ map.name }}</div>
              }
            </div>
            @if (worstMaps.length > 1) {
            <div [class]="'text-wrapper-' + (i === 0 ? '11' : (i === 1 ? '12' : '13'))" [style.color]="getWinRateColor(map.winRate)">
              {{ map.winRate }}%
            </div>
            <div [class]="'text-wrapper-' + (i === 0 ? '4' : (i === 1 ? '8' : '9'))">
              {{ map.name }}
            </div>
            }
            }
          </div>
        </div>
      </div>

      <!-- Лучшие бойцы -->
      <div class="frame-5">
        <div class="text-wrapper-15">ЛУЧШИЕ БОЙЦЫ</div>
        <div class="frame-11">
          <div class="text-wrapper-19">БОЕЦ</div>
          <div class="text-wrapper-20">WR</div>
          <div class="text-wrapper-21">PICK</div>
        </div>

        @for (brawler of bestBrawlers; track brawler.name; let i = $index) {
        <div [class]="i === 0 ? 'frame-6' : (i === 1 ? 'frame-9' : 'frame-10')">
          <div class="frame-7">
            <img class="ellipse" [src]="brawler.avatar" [alt]="brawler.name" />
            <div class="text-wrapper-16">{{ brawler.name }}</div>
          </div>
          <div class="frame-8">
            <div class="text-wrapper-17" [style.color]="getWinRateColor(brawler.winRate)">{{ brawler.winRate }}%</div>
            <div class="text-wrapper-18">{{ brawler.pickRate }}%</div>
          </div>
        </div>
        }
      </div>

      <!-- Худшие бойцы -->
      <div class="frame-5">
        <div class="text-wrapper-22">ХУДШИЕ БОЙЦЫ</div>
        <div class="frame-11">
          <div class="text-wrapper-19">БОЕЦ</div>
          <div class="text-wrapper-20">WR</div>
          <div class="text-wrapper-21">PICK</div>
        </div>

        @for (brawler of worstBrawlers; track brawler.name; let i = $index) {
        <div [class]="i === 0 ? 'frame-6' : (i === 1 ? 'frame-9' : 'frame-10')">
          <div class="frame-7">
            <img class="ellipse" [src]="brawler.avatar" [alt]="brawler.name" />
            <div class="text-wrapper-16">{{ brawler.name }}</div>
          </div>
          <div class="frame-8">
            <div class="text-wrapper-23" [style.color]="getWinRateColor(brawler.winRate)">{{ brawler.winRate }}%</div>
            <div class="text-wrapper-18">{{ brawler.pickRate }}%</div>
          </div>
        </div>
        }
      </div>

      <!-- График последних матчей (дата + соотношение побед/поражений) -->
      <div class="frame-chart">
        <div class="text-wrapper-24">Последние матчи</div>
        <div class="group-2">
          @if (recentMatchesData.length > 0) {
            <app-winrate-chart
              [data]="recentMatchesData"
              [width]="272"
              [height]="180"
              [lineColor]="'#EF7527'"
              [showGrid]="true"
              [showPoints]="true">
            </app-winrate-chart>
          } @else if (!chartLoading && !error) {
            <div class="chart-empty">Нет данных о матчах</div>
          } @else if (chartLoading) {
            <div class="chart-loading">Загрузка...</div>
          }
        </div>
      </div>
    </div>
  </div>
</div>